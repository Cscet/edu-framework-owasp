<?php

namespace Controller\CommandInjection;

use Studoo\EduFramework\Core\Controller\ControllerInterface;
use Studoo\EduFramework\Core\Controller\Request;
use Studoo\EduFramework\Core\View\TwigCore;

class ExploitController implements ControllerInterface
{

    /**
     * @inheritDoc
     */
    public function execute(Request $request): string|null
    {
        if (isset($_POST['submit'])) {

            $output = null;
            $target = $_POST["target"];
            exec( "ping -c 4 $target",$output);
        }

        return TwigCore::getEnvironment()->render(
            'command-injection/exploit.html.twig',
            [
                'titre'   => 'OWASP Command-injection - Exploit',
                'cmd'=> $_POST["cmd"] ?? null,
                'output' => $output ?? null,
            ]
        );
    }
}